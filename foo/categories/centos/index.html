<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos - ICT pages</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="alternate" type="application/rss+xml" href="/categories/centos/index.xml" title="ICT pages">

	<link rel="shortcut icon" href="/favicon.ico">
		
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ICT pages" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ICT pages</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main list" role="main">
	<header class="main__header">
		<h1 class="main__title">Centos</h1>
	</header><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-cryptsetup-luks/" rel="bookmark">
			CentOS Cryptsetup luks / dm_crypt
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2020-07-07T00:00:00Z">July 07, 2020</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>Preparation:</p>
<pre>yum -y install cryptsetup

modprobe dm_crypt
(enables crypt)

lsmod |grep dm_crypt
dm_crypt               27346  0
dm_mod                124461  11 dm_log-dm_mirror-dm_crypt
(checks crypt enabling)
</pre>
<p>Cryptsetup:</p>
<pre>pvcreate /dev/sdb
    Physical volume "/dev/sdb" successfully created.

vgextend centos /dev/sdb
    Volume group "system" successfully extended

lvcreate -n lv_encrypted -L 10G system
    Logical volume "lv_encrypted" created.</pre>
<p>Cryptdevice:</p>
<pre>
cryptsetup luksFormat /dev/system/lv_encrypted

cryptsetup luksOpen /dev/system/lv_encrypted encrypted
    
mkfs.xfs /dev/mapper/encrypted
    
mkdir /encrypted
    
mount /dev/mapper/encrypted /encrypted
    
# lsblk
NAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
sda                       8:0    0   10G  0 disk
├─sda1                    8:1    0  512M  0 part  /boot
└─sda2                    8:2    0  9.5G  0 part
    ├─system-root         253:0    0  7.5G  0 lvm   /
    ├─system-swap         253:1    0    2G  0 lvm   [SWAP]
    └─system-lv_encrypted 253:2    0   10G  0 lvm
    └─encrypted         253:3    0   10G  0 crypt /encrypted
sdb                       8:16   0   10G  0 disk
└─system-lv_encrypted   253:2    0   10G  0 lvm
    └─encrypted           253:3    0   10G  0 crypt /encrypted
sr0      
</pre>
<p>Increase encrypted device:<br>
(close &amp; unmount before)</p>
	</div>
	<div class="list__footer clearfix">
		<a class="list__footer-readmore btn" href="/ict/centos-cryptsetup-luks/">Read more…</a>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-filesystem-operations/" rel="bookmark">
			Filesystem operations (rescan- create- resize- xfs)
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2020-07-02T00:00:00Z">July 02, 2020</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<h3 id="disksh3">Disks</h3></h3>
<p>Rescan existing disks:</p>
<pre>echo 1 > /sys/class/scsi_device/1\:0\:1\:0/device/rescan</pre>
<p>Check new disk:</p>
<pre>fdisk -l /dev/sdb</pre>
<h1 id="quick-new-disk">Quick new disk</h1>
<h2 id="create-new-disk-of-physical-volume-if-you-see-it-with-fdisk--l">Create new disk of physical volume if you see it with &lsquo;fdisk -l&rsquo;</h2>
<pre><code>pvcreate /dev/sdb
</code></pre>
<p>Extend existing volume group with new disk</p>
<pre><code>vgextend rl /dev/sdb
</code></pre>
<p>Extend existing logical volume to the max</p>
<pre><code>lvextend -l +100%FREE /dev/rl/root
</code></pre>
<p>Grow existing files system</p>
<pre><code>xfs_growfs /dev/rl/root
</code></pre>
<h3>Volumes</h3>
<p>Physical / Logical Volumes</p>
Create physical volume
<pre>pvcreate /dev/sda3
    Physical volume "/dev/sda3" successfully created.</pre>
Resize physical volume (e.g. extended in VMware)   
<pre>pvresize /dev/sdb</pre>
<pre>pvdisplay</pre>
Extend physical volume group 
<pre>vgextend centos /dev/sda3
    Volume group "centos" successfully extended​</pre>
<pre>vgdisplay</pre>
Extend logical volume<br>
in G'igs
<pre>lvextend -L +8G /dev/system/volume</pre>
or full (using everything)
<pre>lvextend -l 100%FREE /dev/mapper/volume</pre>
Grow filesystem
<pre>xfs_growfs /dev/system/volume</pre>
Create new logical volume
<pre>mkfs.xfs /dev/centos/volume</pre>
see: <a href="centos-new-partition-on-existing-disk.html">CentOS New Partition on existing disk</a>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-remove-old-kernels/" rel="bookmark">
			Remove old kernels
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2020-03-24T00:00:00Z">March 24, 2020</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>Current running kernel</p>
<pre><code>uname -an
</code></pre>
<p>Show installed kernels:</p>
<pre><code>rpm -q kernel
</code></pre>
<p><b>CentOS 7:</b>
Remove old kernels with package-cleanup (yum-utils required)</p>
<pre><code>package-cleanup --oldkernels package-cleanup --oldkernels --count=2
</code></pre>
<p><b>CentOS 8:</b> Remove old kernels with dnf</p>
<pre><code>dnf remove --oldinstallonly
dnf remove --oldinstallonly --setopt installonly_limit=2
</code></pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-postfix-configuration/" rel="bookmark">
			CentOS Postfix Configuration
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2017-04-22T00:00:00Z">April 22, 2017</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>Scenario: Homeserver should send e-mails by your ISP-hosted domain:</p>
<p>Packages:</p>
<pre><code>yum -y install postfix
</code></pre>
<p>Edit the following lines in the postfix main config:</p>
<pre><code>/etc/postfix/main.cf

mydomain = &quot;MY-DOMAIN&quot;
myorigin = $myhostname
myorigin = $mydomain
inet_interfaces = all
inet_interfaces = localhost
inet_protocols = ipv4
mydestination = $myhostname- localhost.$mydomain- localhost
mynetworks_style = host
relayhost = &lt;STMP.HOST.ADDRESS&gt;:&lt;PORT&gt;
smtpd_sasl_auth_enable = yes
smtpd_sasl_path = smtpd
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
smtp_sasl_type = cyrus
smtp_sasl_auth_enable = yes
smtp_sasl_security_options = noanonymous
</code></pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-disable-root-login/" rel="bookmark">
			Disable root login
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2015-12-23T00:00:00Z">December 23, 2015</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<pre><code>vi /etc/ssh/sshd_config
PermitRootLogin no
</code></pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-configure-static-ip-address/" rel="bookmark">
			Configure static IP address
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2015-09-09T00:00:00Z">September 09, 2015</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>Position of the interface configuration files:</p>
<pre><code>/etc/sysconfig/network-scripts
</code></pre>
<p>ip addr</p>
<p>shows the names of available interfaces:</p>
<pre><code>enp0s3: &lt;BROADCAST-MULTICAST-UP-LOWER_UP&gt; mtu 1500 qdisc
pfifo_fast state UP qlen 1000
link/ether 08:00:27:66:c7:99 brd ff:ff:ff:ff:ff:ff
inet 192.168.0.40/24 brd 192.168.0.255 scope global enp0s3
valid_lft forever preferred_lft forever
inet6 fe80::a00:27ff:fe66:c799/64 scope link
valid_lft forever preferred_lft forever
</code></pre>
<p>Now the config file ifcfg-enp0s3 can be edited with the static config:</p>
<pre><code>TYPE=&quot;Ethernet&quot;
NAME=&quot;enp0s3&quot;
ONBOOT=&quot;yes&quot;
IPADDR=&quot;192.168.0.40&quot;  
BOOTPROTO=&quot;static&quot; 
GATEWAY=&quot;192.168.0.1&quot;
</code></pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-locale-status/" rel="bookmark">
			status / set-locale
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2015-09-09T00:00:00Z">September 09, 2015</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>Show and edit locale status on CentOS:</p>
<p>Show locale status:</p>
<pre>[root@host]# localectl status
System Locale: LANG=de_DE.UTF-8
VC Keymap: sg
X11 Layout: ch
Show all possible locaels:
localectl list-locales
</pre>
<p>Setzen der neuen locale:</p>
<pre>localectl set-locale LANG="locale name"
locale</pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-hostname/" rel="bookmark">
			Change hostname
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2015-09-08T00:00:00Z">September 08, 2015</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<p>With CentOS7 Release hostnames must be changed by &lsquo;hostnamectl&rsquo;:</p>
<pre><code>hostnamectl set-hostname &quot;New Hostname&quot;
</code></pre>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/centos-mount-nfs-share/" rel="bookmark">
			Mount nfs share
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2015-09-07T00:00:00Z">September 07, 2015</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<ol>
<li>
<p>Setup NFS Client:</p>
<p>yum -y install nfs-utils</p>
</li>
<li>
<p>Create mountpoint:</p>
<p>mkdir -p /mnt/nfs/example-share</p>
</li>
</ol>
<p>Mount NFS share:</p>
<pre><code>mount &lt;HOST&gt;:/example-share /mnt/nfs/example-share
hint: –&gt; df -h
hint: –&gt; mount – show all mounts
</code></pre>
<ol start="3">
<li>
<p>Add mount to fstab for remounting after reboot:</p>
<p>vi /etc/fstab <HOST>:/example-share /mnt/nfs/</p>
</li>
</ol>
	</div>
</article><article class="list__item post">
	
	<header class="list__header">
		<h2 class="list__title post__title">
			<a href="/ict/mk-test/" rel="bookmark">
			
			</a>
		</h2>
		<div class="list__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2010-12-03T00:00:00Z">December 03, 2010</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/centos/" rel="category">Centos</a>
	</span>
</div></div>
	</header>
	<div class="content list__excerpt post__content clearfix">
		<h1 id="centos-linux-fail2ban">CentOS Linux fail2ban</h1>
<p>On exposed systems to the internet fail2ban is used to avoid attacks e.g. on ssh deamon.
This shows the install and config on the CentOS 7.2 release with using firewalld (preinstalled).
First install fail2ban from repo:</p>
<pre>yum -y install fail2ban</pre>
<p>For own settings the main config ‘jail.conf’ could be copied.</p>
<pre>cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</pre>
<p>Now you can edit ‘jail.local’ with your own fonfigurations.</p>
<pre>[sshd] #--> uncommend to activate fail2ban for sshd
enabled = true #--> use firewalld not iptables
ignoreip = 192.168.2.0 #--> fail2ban ignores these ip's
destemail =  e-mail@address.ch #--> fail2ban sends ban informations to this address
sendername = Fail2Ban - hostname #--> hostinfos in e-mail
usedns = no #--> don't resolve dns names</pre>
<p>Now you can enable and start the fail2ban deamon:</p>
	</div>
	<div class="list__footer clearfix">
		<a class="list__footer-readmore btn" href="/ict/mk-test/">Read more…</a>
	</div>
</article>
</main>

<div class="pagination">
	<span class="pagination__item pagination__item--current">1/2</span>
	<a class="pagination__item pagination__item--next btn" href="/categories/centos/page/2/">»</a>
</div>

			</div>
			

		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 ICT pages.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>